# -*- coding: utf-8 -*-
"""Loan Status Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1IOLgfoiCayhAYH3ipktRPW-0DYkBTr5O

Importing the Dependencies
"""

import numpy as np
import pandas as pd
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn import svm
from sklearn.metrics import accuracy_score

import matplotlib.pyplot as plt
import matplotlib.patheffects as pe

"""Data Collection and Processing"""

# loding dataset to pandas DataFrame
loan_dataset = pd.read_csv('/content/loan_dataset.csv')

type(loan_dataset)

# printing first 5 rows of the dataframe
loan_dataset.head()

# number of rows and columns
loan_dataset.shape

# statistical measures
loan_dataset.describe()

# number of missing values in each columns
loan_dataset.isnull().sum()

# droping the missing values
loan_dataset = loan_dataset.dropna()

# number of missing values in each columns
loan_dataset.isnull().sum()

# label endoding
loan_dataset.replace({"Loan_Status":{'N':0,'Y':1}},inplace=True)

# printing first 5 rows of the dataframe
loan_dataset.head()

# Dependent column values
loan_dataset['Dependents'].value_counts()

# replacing the value of 3+ to 4
loan_dataset = loan_dataset.replace(to_replace='3+', value=4)

# dependent value
loan_dataset['Dependents'].value_counts()

"""Data Visualization"""

# education & Lone Status

# ---------------- Create Dark Scientific Theme in Seaborn ----------------
sns.set_theme(
    style="darkgrid",
    rc={
        "axes.facecolor": "black",
        "figure.facecolor": "black",
        "grid.color": "white",
        "grid.linestyle": ":",
        "grid.linewidth": 0.8,
        "axes.edgecolor": "white",
        "xtick.color": "white",
        "ytick.color": "white",
        "axes.labelcolor": "white",
        "text.color": "white"
    }
)

plt.figure(figsize=(10,6))

# ---------------- Neon Palette ----------------
neon_palette = ["#00eaff", "#ff3b3b"]   # cyan + neon red

# ---------------- SEABORN Countplot ----------------
ax = sns.countplot(
    x='Education',
    hue='Loan_Status',
    data=loan_dataset,
    palette=neon_palette,
    linewidth=1.3,
    edgecolor="white"
)

# ---------------- Glow Effect (Matplotlib Enhancement) ----------------
for p in ax.patches:
    p.set_path_effects([
        pe.Stroke(linewidth=6, foreground='black', alpha=0.6),
        pe.Normal()
    ])

# ---------------- Make Grid "Glow" ----------------
for line in ax.get_ygridlines():
    line.set_path_effects([
        pe.Stroke(linewidth=2.5, foreground='black', alpha=0.55),
        pe.Normal()
    ])

# ---------------- Labels ----------------
ax.set_xlabel("Education Level", fontsize=16, fontweight="bold", labelpad=12)
ax.set_ylabel("Count", fontsize=16, fontweight="bold", labelpad=12)

# ---------------- Title with Glow ----------------
title = ax.set_title("Education vs Loan Status",
                     fontsize=20, fontweight="semibold", pad=18)

title.set_path_effects([
    pe.Stroke(linewidth=6, foreground='black', alpha=0.7),
    pe.Normal()
])

# ---------------- Legend ----------------
leg = ax.legend(title="Loan Status", fontsize=12)
plt.setp(leg.get_title(), fontsize=13, weight="bold")

# ---------------- Tick Styling ----------------
ax.tick_params(axis='both', labelsize=13)

plt.tight_layout()
plt.show()

sns.countplot(x='Married',hue='Loan_Status',data=loan_dataset)

# convert categorical columns to numerical values
loan_dataset.replace({'Married':{'No':0,'Yes':1},'Gender':{'Male':1,'Female':0},'Self_Employed':{'No':0,'Yes':1},'Property_Area':{'Rural':0,'Semiurban':1,'Urban':2},'Education':{'Graduate':1,'Not Graduate':0}},inplace=True)

loan_dataset.head()

from re import X
# separating the data and label
X = loan_dataset.drop(columns=['Loan_ID','Loan_Status'],axis=1)
Y = loan_dataset['Loan_Status']

print(X)
print(Y)

"""Train Test Split"""

X_train, X_test, Y_train, Y_test = train_test_split(X,Y,test_size=0.1,stratify=Y,random_state=2)

print(X.shape,X_train.shape,X_test.shape)

"""Training the model:

Support Vector Mechine Model
"""

classifier = svm.SVC(kernel='linear')

# training the Support Vector Machine Model
classifier.fit(X_train,Y_train)

"""Model Evaluation"""

# accuracy score on training data
X_train_prediction = classifier.predict(X_train)
training_data_accuracy = accuracy_score(X_train_prediction,Y_train)

print('Accuracy on training data:', training_data_accuracy*100)

# accuracy score on test data
X_test_prediction = classifier.predict(X_test)
test_data_accuracy = accuracy_score(X_test_prediction,Y_test)

print('Accuracy on training data:', test_data_accuracy*100)

"""Making a preductive system"""

def predict_loan_status(gender, married, dependents, education, self_employed, applicant_income, coapplicant_income, loan_amount, loan_amount_term, credit_history, property_area):
    # Convert inputs to a NumPy array
    input_data = np.array([gender, married, dependents, education, self_employed, applicant_income, coapplicant_income, loan_amount, loan_amount_term, credit_history, property_area])

    # Reshape the array for the model (1 sample, 11 features)
    input_data_reshaped = input_data.reshape(1, -1)

    # Make prediction using the trained classifier
    prediction = classifier.predict(input_data_reshaped)

    # Print the prediction result
    if prediction[0] == 1:
        print('Loan Approved')
    else:
        print('Loan Not Approved')

gender = int(input("Enter Gender (1 for Male, 0 for Female): "))
married = int(input("Enter Married status (1 for Yes, 0 for No): "))
dependents = int(input("Enter Dependents (0, 1, 2, or 4 for '3+'): "))
education = int(input("Enter Education (1 for Graduate, 0 for Not Graduate): "))
self_employed = int(input("Enter Self_Employed status (1 for Yes, 0 for No): "))
applicant_income = float(input("Enter ApplicantIncome: "))
coapplicant_income = float(input("Enter CoapplicantIncome: "))
loan_amount = float(input("Enter LoanAmount: "))
loan_amount_term = float(input("Enter Loan_Amount_Term: "))
credit_history = float(input("Enter Credit_History (1.0 for meeting guidelines, 0.0 otherwise): "))
property_area = int(input("Enter Property_Area (0 for Rural, 1 for Semiurban, 2 for Urban): "))

predict_loan_status(gender, married, dependents, education, self_employed, applicant_income, coapplicant_income, loan_amount, loan_amount_term, credit_history, property_area)